{% extends 'base.html' %}

{% block title %}Solicitação de Empréstimo{% endblock %}

{% block content %}

{% if context %}


<div class="container mx-auto shadow p-4 w-75">
    <form method="post">
        {{ context.form.book_id }}
        {{ context.form.borrower_id }}
        {% csrf_token %}
        <div class="row">
            <div class="col col-12 col-md-4 offset-md-4">
                <h6>Solicitação de empréstimo de </h6>
                <h4>{{ context.book_title }}</h4>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col col-12 col-md-4 offset-md-4">
                {{context.form.date_borrowed}}
            </div>
        </div>
        <div class="row mt-3">
            <div class="col col-12 col-md-4 offset-md-4 form-check form-check-inline border">
                {% for item in context.form.schedule %}
                {{ item}}
                {% endfor %}
            </div>
        </div>
        <div class="row mt-3 text-center">
            <div class="col col-12 col-md-4 offset-md-4">
                <input type="submit" value="Solicitar" class="btn btn-primary">
            </div>
        </div>
    </form>
    {% if context.form.errors %}
    <div class="row mt-2 p-2">
        <div class="col col-12">
            <div class="alert alert-danger">
                {{ context.form.errors.date_borrowed }}
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endif %}

{% if borrowed %}
<div class="container mx-auto shadow p-4 w-75">
    <h4>Você já tem um empréstimo ativo</h4>
    <p>Você só poderá pedir outro empréstimo quando devolver o livro atual.</p>

    <div class="row">
        <div class="col col12">
            <h6>{{ borrowed.book.title }}</h6>
        </div>
    </div>
    <div class="row">
        <div class="col col-12">
            <strong>Data do empréstimo: </strong>{{ borrowed.date_borrowed|date:"D d/M/Y" }} <br />
            <strong>Data de prevista da devolução: </strong>{{ borrowed.return_forecast|date:"D d/M/Y" }} às
            {{borrowed.schedule|date:"H:i"}}<br />
        </div>
    </div>
    {% endif %}

    {% endblock %}